/*! 
 Build based on gin-vue-admin 
 Time : 1705585352000 */
import{r as e,a as l,o as a,c as t,b as o,d as i,w as u,g as d,t as n,h as r,I as p,e as m,G as s,cW as c,cX as v,cY as f,U as h,cZ as b,k as w,c_ as y,c$ as g,d0 as _,E as V,J as k,l as j,p as I,i as x}from"./index-0efc4537.js";import{E as D}from"./dialog-2a3abe36.js";import"./overlay-73152bda.js";import{a as U,E as C}from"./form-150c0e00.js";/* empty css                *//* empty css               */import{E as B}from"./cascader-panel-8d54ab04.js";/* empty css              */import"./tag-c095386a.js";import{E as A}from"./checkbox-aefa5e2d.js";import"./radio-86f43203.js";import"./scrollbar-ab08f6f1.js";import{E,a as T}from"./select-59043028.js";/* empty css                  */import{E as N,a as q}from"./table-column-ce6481a3.js";/* empty css             *//* empty css               */import M from"./icon-55ee953a.js";import{W as S}from"./warningBar-5328b630.js";import{c as z}from"./authorityBtn-d967b7d6.js";import{t as F}from"./doc-46160848.js";import{_ as P}from"./_plugin-vue_export-helper-1b428a4d.js";import{E as $}from"./index-70d4cce8.js";import"./refs-04938f0e.js";import"./isUndefined-d281c39a.js";import"./castArray-f160d2a3.js";import"./_baseClone-9af99e91.js";import"./_Uint8Array-4999d338.js";import"./_initCloneObject-b273bb42.js";import"./rand-099990c4.js";import"./strings-a95e1d29.js";import"./isEqual-aa7e7ef2.js";import"./cloneDeep-585751f1.js";import"./index-c5b62cef.js";import"./index-4b62258d.js";import"./debounce-994b39f4.js";import"./hasIn-deea815f.js";const J=e=>(I("data-v-df9ba25d"),e=e(),x(),e),K={class:"gva-table-box"},O={class:"gva-btn-list"},W={key:0,class:"icon-column"},G={style:{display:"inline-flex","align-items":"center"}},H=J((()=>o("span",null,"路由Path",-1))),L=J((()=>o("span",{style:{"font-size":"12px","margin-right":"12px"}},"如果菜单包含子菜单，请创建router-view二级路由页面或者",-1))),X=J((()=>o("span",null," 高亮菜单 ",-1))),Y=J((()=>o("span",null," 是否为基础页面 ",-1))),Z={class:"flex items-center gap-2"},Q={class:"flex items-center gap-2 mt-3"},R={class:"dialog-footer"},ee=P(Object.assign({name:"Menus"},{__name:"menu",setup(I){const x=e({path:[{required:!0,message:"请输入菜单name",trigger:"blur"}],component:[{required:!0,message:"请输入文件路径",trigger:"blur"}],"meta.title":[{required:!0,message:"请输入菜单展示名称",trigger:"blur"}]}),P=l(1),J=l(0),ee=l(999),le=l([]),ae=l({}),te=async()=>{const e=await f({page:P.value,pageSize:ee.value,...ae.value});0===e.code&&(le.value=e.data.list,J.value=e.data.total,P.value=e.data.page,ee.value=e.data.pageSize)};te();const oe=()=>{ie.value.component=ie.value.component.replace(/\\/g,"/")},ie=l({ID:0,path:"",name:"",hidden:!1,parentId:"",component:"",meta:{activeName:"",title:"",icon:"",defaultMenu:!1,closeTab:!1,keepAlive:!1},parameters:[],menuBtn:[]}),ue=()=>{ie.value.path=ie.value.name},de=e=>{pe(),e()},ne=l(null),re=l(!1),pe=()=>{re.value=!1,ne.value.resetFields(),ie.value={ID:0,path:"",name:"",hidden:!1,parentId:"",component:"",meta:{title:"",icon:"",defaultMenu:!1,closeTab:!1,keepAlive:!1}}},me=l(!1),se=()=>{pe(),me.value=!1},ce=async()=>{ne.value.validate((async e=>{if(e){let e;e=be.value?await y(ie.value):await g(ie.value),0===e.code&&(w({type:"success",message:be.value?"编辑成功":"添加成功!"}),te()),pe(),me.value=!1}}))},ve=l([{ID:"0",title:"根菜单"}]),fe=()=>{ve.value=[{ID:"0",title:"根目录"}],he(le.value,ve.value,!1)},he=(e,l,a)=>{e&&e.forEach((e=>{if(e.children&&e.children.length){const t={title:e.meta.title,ID:String(e.ID),disabled:a||e.ID===ie.value.ID,children:[]};he(e.children,t.children,a||e.ID===ie.value.ID),l.push(t)}else{const t={title:e.meta.title,ID:String(e.ID),disabled:a||e.ID===ie.value.ID};l.push(t)}}))},be=l(!1),we=l("新增菜单"),ye=e=>{we.value="新增菜单",ie.value.parentId=String(e),be.value=!1,fe(),me.value=!0};return(e,l)=>{const f=V,y=N,g=k,I=q,J=j,ee=U,ae=A,pe=E,he=T,ge=B,_e=$,Ve=C,ke=D;return a(),t("div",null,[o("div",K,[o("div",O,[i(f,{type:"primary",icon:"plus",onClick:l[0]||(l[0]=e=>ye("0"))},{default:u((()=>[d("新增根菜单")])),_:1})]),i(I,{data:le.value,"row-key":"ID"},{default:u((()=>[i(y,{align:"left",label:"ID","min-width":"100",prop:"ID"}),i(y,{align:"left",label:"展示名称","min-width":"120",prop:"authorityName"},{default:u((e=>[o("span",null,n(e.row.meta.title),1)])),_:1}),i(y,{align:"left",label:"图标","min-width":"140",prop:"authorityName"},{default:u((e=>[e.row.meta.icon?(a(),t("div",W,[i(g,null,{default:u((()=>[(a(),r(p(e.row.meta.icon)))])),_:2},1024),o("span",null,n(e.row.meta.icon),1)])):m("",!0)])),_:1}),i(y,{align:"left",label:"路由Name","show-overflow-tooltip":"","min-width":"160",prop:"name"}),i(y,{align:"left",label:"路由Path","show-overflow-tooltip":"","min-width":"160",prop:"path"}),i(y,{align:"left",label:"是否隐藏","min-width":"100",prop:"hidden"},{default:u((e=>[o("span",null,n(e.row.hidden?"隐藏":"显示"),1)])),_:1}),i(y,{align:"left",label:"父节点","min-width":"90",prop:"parentId"}),i(y,{align:"left",label:"排序","min-width":"70",prop:"sort"}),i(y,{align:"left",label:"文件路径","min-width":"360",prop:"component"}),i(y,{align:"left",fixed:"right",label:"操作",width:"300"},{default:u((e=>[i(f,{type:"primary",link:"",icon:"plus",onClick:l=>ye(e.row.ID)},{default:u((()=>[d("添加子菜单")])),_:2},1032,["onClick"]),i(f,{type:"primary",link:"",icon:"edit",onClick:l=>(async e=>{we.value="编辑菜单";const l=await _({id:e});ie.value=l.data.menu,be.value=!0,fe(),me.value=!0})(e.row.ID)},{default:u((()=>[d("编辑")])),_:2},1032,["onClick"]),i(f,{type:"primary",link:"",icon:"delete",onClick:l=>{return a=e.row.ID,void h.confirm("此操作将永久删除所有角色下该菜单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await b({ID:a})).code&&(w({type:"success",message:"删除成功!"}),1===le.value.length&&P.value>1&&P.value--,te())})).catch((()=>{w({type:"info",message:"已取消删除"})}));var a}},{default:u((()=>[d("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),i(ke,{modelValue:me.value,"onUpdate:modelValue":l[19]||(l[19]=e=>me.value=e),"before-close":de,title:we.value},{footer:u((()=>[o("div",R,[i(f,{onClick:se},{default:u((()=>[d("取 消")])),_:1}),i(f,{type:"primary",onClick:ce},{default:u((()=>[d("确 定")])),_:1})])])),default:u((()=>[i(S,{title:"新增菜单，需要在角色管理内配置权限才可使用"}),me.value?(a(),r(Ve,{key:0,ref_key:"menuForm",ref:ne,inline:!0,model:ie.value,rules:x,"label-position":"top","label-width":"85px"},{default:u((()=>[i(ee,{label:"路由Name",prop:"path",style:{width:"30%"}},{default:u((()=>[i(J,{modelValue:ie.value.name,"onUpdate:modelValue":l[1]||(l[1]=e=>ie.value.name=e),autocomplete:"off",placeholder:"唯一英文字符串",onChange:ue},null,8,["modelValue"])])),_:1}),i(ee,{prop:"path",style:{width:"30%"}},{label:u((()=>[o("span",G,[H,i(ae,{modelValue:re.value,"onUpdate:modelValue":l[2]||(l[2]=e=>re.value=e),style:{"margin-left":"12px",height:"auto"}},{default:u((()=>[d("添加参数")])),_:1},8,["modelValue"])])])),default:u((()=>[i(J,{modelValue:ie.value.path,"onUpdate:modelValue":l[3]||(l[3]=e=>ie.value.path=e),disabled:!re.value,autocomplete:"off",placeholder:"建议只在后方拼接参数"},null,8,["modelValue","disabled"])])),_:1}),i(ee,{label:"是否隐藏",style:{width:"30%"}},{default:u((()=>[i(he,{modelValue:ie.value.hidden,"onUpdate:modelValue":l[4]||(l[4]=e=>ie.value.hidden=e),placeholder:"是否在列表隐藏"},{default:u((()=>[i(pe,{value:!1,label:"否"}),i(pe,{value:!0,label:"是"})])),_:1},8,["modelValue"])])),_:1}),i(ee,{label:"父节点ID",style:{width:"30%"}},{default:u((()=>[i(ge,{modelValue:ie.value.parentId,"onUpdate:modelValue":l[5]||(l[5]=e=>ie.value.parentId=e),style:{width:"100%"},disabled:!be.value,options:ve.value,props:{checkStrictly:!0,label:"title",value:"ID",disabled:"disabled",emitPath:!1},"show-all-levels":!1,filterable:""},null,8,["modelValue","disabled","options"])])),_:1}),i(ee,{label:"文件路径",prop:"component",style:{width:"60%"}},{default:u((()=>[i(J,{modelValue:ie.value.component,"onUpdate:modelValue":l[6]||(l[6]=e=>ie.value.component=e),autocomplete:"off",placeholder:"页面:view/xxx/xx.vue 插件:plugin/xx/xx.vue",onBlur:oe},null,8,["modelValue"]),L,i(f,{style:{"margin-top":"4px"},onClick:l[7]||(l[7]=e=>ie.value.component="view/routerHolder.vue")},{default:u((()=>[d("点我设置")])),_:1})])),_:1}),i(ee,{label:"展示名称",prop:"meta.title",style:{width:"30%"}},{default:u((()=>[i(J,{modelValue:ie.value.meta.title,"onUpdate:modelValue":l[8]||(l[8]=e=>ie.value.meta.title=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(ee,{label:"图标",prop:"meta.icon",style:{width:"30%"}},{default:u((()=>[i(M,{meta:ie.value.meta,style:{width:"100%"}},null,8,["meta"])])),_:1}),i(ee,{label:"排序标记",prop:"sort",style:{width:"30%"}},{default:u((()=>[i(J,{modelValue:ie.value.sort,"onUpdate:modelValue":l[9]||(l[9]=e=>ie.value.sort=e),modelModifiers:{number:!0},autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(ee,{prop:"meta.activeName",style:{width:"30%"}},{label:u((()=>[o("div",null,[X,i(_e,{content:"注：当到达此路由时候，指定左侧菜单指定name会处于活跃状态（亮起），可为空，为空则为本路由Name。",placement:"top",effect:"light"},{default:u((()=>[i(g,null,{default:u((()=>[i(s(c))])),_:1})])),_:1})])])),default:u((()=>[i(J,{modelValue:ie.value.meta.activeName,"onUpdate:modelValue":l[10]||(l[10]=e=>ie.value.meta.activeName=e),placeholder:ie.value.name,autocomplete:"off"},null,8,["modelValue","placeholder"])])),_:1}),i(ee,{label:"KeepAlive",prop:"meta.keepAlive",style:{width:"30%"}},{default:u((()=>[i(he,{modelValue:ie.value.meta.keepAlive,"onUpdate:modelValue":l[11]||(l[11]=e=>ie.value.meta.keepAlive=e),style:{width:"100%"},placeholder:"是否keepAlive缓存页面"},{default:u((()=>[i(pe,{value:!1,label:"否"}),i(pe,{value:!0,label:"是"})])),_:1},8,["modelValue"])])),_:1}),i(ee,{label:"CloseTab",prop:"meta.closeTab",style:{width:"30%"}},{default:u((()=>[i(he,{modelValue:ie.value.meta.closeTab,"onUpdate:modelValue":l[12]||(l[12]=e=>ie.value.meta.closeTab=e),style:{width:"100%"},placeholder:"是否自动关闭tab"},{default:u((()=>[i(pe,{value:!1,label:"否"}),i(pe,{value:!0,label:"是"})])),_:1},8,["modelValue"])])),_:1}),i(ee,{style:{width:"30%"}},{label:u((()=>[o("div",null,[Y,i(_e,{content:"此项选择为是，则不会展示左侧菜单以及顶部信息。",placement:"top",effect:"light"},{default:u((()=>[i(g,null,{default:u((()=>[i(s(c))])),_:1})])),_:1})])])),default:u((()=>[i(he,{modelValue:ie.value.meta.defaultMenu,"onUpdate:modelValue":l[13]||(l[13]=e=>ie.value.meta.defaultMenu=e),style:{width:"100%"},placeholder:"是否为基础页面"},{default:u((()=>[i(pe,{value:!1,label:"否"}),i(pe,{value:!0,label:"是"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])):m("",!0),o("div",null,[o("div",Z,[i(f,{type:"primary",icon:"edit",onClick:l[14]||(l[14]=e=>{return(l=ie.value).parameters||(l.parameters=[]),void l.parameters.push({type:"query",key:"",value:""});var l})},{default:u((()=>[d("新增菜单参数")])),_:1}),i(g,{class:"cursor-pointer",onClick:l[15]||(l[15]=e=>s(F)("https://www.bilibili.com/video/BV1kv4y1g7nT?p=9&vd_source=f2640257c21e3b547a790461ed94875e"))},{default:u((()=>[i(s(v))])),_:1})]),i(I,{data:ie.value.parameters,style:{width:"100%","margin-top":"12px"}},{default:u((()=>[i(y,{align:"left",prop:"type",label:"参数类型",width:"180"},{default:u((e=>[i(he,{modelValue:e.row.type,"onUpdate:modelValue":l=>e.row.type=l,placeholder:"请选择"},{default:u((()=>[i(pe,{key:"query",value:"query",label:"query"}),i(pe,{key:"params",value:"params",label:"params"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(y,{align:"left",prop:"key",label:"参数key",width:"180"},{default:u((e=>[o("div",null,[i(J,{modelValue:e.row.key,"onUpdate:modelValue":l=>e.row.key=l},null,8,["modelValue","onUpdate:modelValue"])])])),_:1}),i(y,{align:"left",prop:"value",label:"参数值"},{default:u((e=>[o("div",null,[i(J,{modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l},null,8,["modelValue","onUpdate:modelValue"])])])),_:1}),i(y,{align:"left"},{default:u((e=>[o("div",null,[i(f,{type:"danger",icon:"delete",onClick:l=>{return a=ie.value.parameters,t=e.$index,void a.splice(t,1);var a,t}},{default:u((()=>[d("删除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"]),o("div",Q,[i(f,{type:"primary",icon:"edit",onClick:l[16]||(l[16]=e=>{return(l=ie.value).menuBtn||(l.menuBtn=[]),void l.menuBtn.push({name:"",desc:""});var l})},{default:u((()=>[d("新增可控按钮 ")])),_:1}),i(g,{class:"cursor-pointer",onClick:l[17]||(l[17]=e=>s(F)("https://www.gin-vue-admin.com/guide/web/button-auth.html"))},{default:u((()=>[i(s(c))])),_:1}),i(g,{class:"cursor-pointer",onClick:l[18]||(l[18]=e=>s(F)("https://www.bilibili.com/video/BV1kv4y1g7nT?p=11&vd_source=f2640257c21e3b547a790461ed94875e"))},{default:u((()=>[i(s(v))])),_:1})]),i(I,{data:ie.value.menuBtn,style:{width:"100%","margin-top":"12px"}},{default:u((()=>[i(y,{align:"left",prop:"name",label:"按钮名称",width:"180"},{default:u((e=>[o("div",null,[i(J,{modelValue:e.row.name,"onUpdate:modelValue":l=>e.row.name=l},null,8,["modelValue","onUpdate:modelValue"])])])),_:1}),i(y,{align:"left",prop:"name",label:"备注",width:"180"},{default:u((e=>[o("div",null,[i(J,{modelValue:e.row.desc,"onUpdate:modelValue":l=>e.row.desc=l},null,8,["modelValue","onUpdate:modelValue"])])])),_:1}),i(y,{align:"left"},{default:u((e=>[o("div",null,[i(f,{type:"danger",icon:"delete",onClick:l=>(async(e,l)=>{const a=e[l];if(0===a.ID)return void e.splice(l,1);0===(await z({id:a.ID})).code&&e.splice(l,1)})(ie.value.menuBtn,e.$index)},{default:u((()=>[d("删除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-df9ba25d"]]);export{ee as default};

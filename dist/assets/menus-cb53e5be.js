/*! 
 Build based on gin-vue-admin 
 Time : 1705585352000 */
import{a as e,$ as t,o as a,c as o,b as s,d as l,w as r,g as n,t as i,H as u,e as d,cO as c,cP as m,k as p,cQ as y,P as f,l as h,E as j}from"./index-0efc4537.js";import{E as v}from"./dialog-2a3abe36.js";import"./overlay-73152bda.js";import{E as w,a as k}from"./table-column-ce6481a3.js";import"./checkbox-aefa5e2d.js";/* empty css                *//* empty css               */import"./scrollbar-ab08f6f1.js";import"./tag-c095386a.js";import{E as I}from"./tree-1161bc64.js";/* empty css               *//* empty css              */import{u as b}from"./authority-0dff6ed3.js";import{g,s as _}from"./authorityBtn-d967b7d6.js";import{_ as x}from"./_plugin-vue_export-helper-1b428a4d.js";import"./refs-04938f0e.js";import"./isUndefined-d281c39a.js";import"./index-70d4cce8.js";import"./_Uint8Array-4999d338.js";import"./_initCloneObject-b273bb42.js";import"./hasIn-deea815f.js";import"./debounce-994b39f4.js";import"./index-4b62258d.js";import"./isEqual-aa7e7ef2.js";import"./index-55d5e59b.js";const C={class:"sticky top-0.5 z-10 bg-white"},R={class:"tree-content clear-both"},E={class:"custom-tree-node"},D={key:0},V={class:"dialog-footer"},N=x(Object.assign({name:"Menus"},{__name:"menus",props:{row:{default:function(){return{}},type:Object}},emits:["changeRow"],setup(x,{expose:N,emit:O}){const A=x,U=O,B=e(""),M=e([]),P=e([]),S=e(!1),T=e({children:"children",label:function(e){return e.meta.title}});(async()=>{const e=await c();M.value=e.data.menus;const t=(await m({authorityId:A.row.authorityId})).data.menus,a=[];t.forEach((e=>{t.some((t=>t.parentId===e.menuId))||a.push(Number(e.menuId))})),P.value=a})();const q=()=>{S.value=!0},z=e(null),F=async()=>{const e=z.value.getCheckedNodes(!1,!0);0===(await y({menus:e,authorityId:A.row.authorityId})).code&&p({type:"success",message:"菜单设置成功!"})};N({enterAndNext:()=>{F()},needConfirm:S});const H=e(!1),K=e([]),Q=e([]),W=e();let $="";const G=e=>{Q.value=e},J=e=>{H.value=!0,K.value=e.menuBtn},L=()=>{H.value=!1},X=async()=>{const e=Q.value.map((e=>e.ID));0===(await _({menuID:$,selected:e,authorityId:A.row.authorityId})).code&&(p({type:"success",message:"设置成功"}),H.value=!1)},Y=(e,t)=>!e||-1!==t.meta.title.indexOf(e);return t(B,(e=>{z.value.filter(e)})),(e,t)=>{const c=h,m=j,y=I,_=w,N=k,O=v;return a(),o("div",null,[s("div",C,[l(c,{modelValue:B.value,"onUpdate:modelValue":t[0]||(t[0]=e=>B.value=e),class:"w-3/5",placeholder:"筛选"},null,8,["modelValue"]),l(m,{class:"float-right",type:"primary",onClick:F},{default:r((()=>[n("确 定")])),_:1})]),s("div",R,[l(y,{ref_key:"menuTree",ref:z,data:M.value,"default-checked-keys":P.value,props:T.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"","filter-node-method":Y,onCheck:q},{default:r((({node:e,data:t})=>[s("span",E,[s("span",null,i(e.label),1),s("span",null,[l(m,{type:"primary",link:"",style:u({color:x.row.defaultRouter===t.name?"#E6A23C":"#85ce61"}),disabled:!e.checked,onClick:()=>(async e=>{const t=await b({authorityId:A.row.authorityId,AuthorityName:A.row.authorityName,parentId:A.row.parentId,defaultRouter:e.name});0===t.code&&(p({type:"success",message:"设置成功"}),U("changeRow","defaultRouter",t.data.authority.defaultRouter))})(t)},{default:r((()=>[n(i(x.row.defaultRouter===t.name?"首页":"设为首页"),1)])),_:2},1032,["style","disabled","onClick"])]),t.menuBtn.length?(a(),o("span",D,[l(m,{type:"primary",link:"",onClick:()=>(async e=>{$=e.ID;const t=await g({menuID:$,authorityId:A.row.authorityId});0===t.code&&(J(e),await f(),t.data.selected&&t.data.selected.forEach((e=>{K.value.some((t=>{t.ID===e&&W.value.toggleRowSelection(t,!0)}))})))})(t)},{default:r((()=>[n(" 分配按钮 ")])),_:2},1032,["onClick"])])):d("",!0)])])),_:1},8,["data","default-checked-keys","props"])]),l(O,{modelValue:H.value,"onUpdate:modelValue":t[1]||(t[1]=e=>H.value=e),title:"分配按钮","destroy-on-close":""},{footer:r((()=>[s("div",V,[l(m,{onClick:L},{default:r((()=>[n("取 消")])),_:1}),l(m,{type:"primary",onClick:X},{default:r((()=>[n("确 定")])),_:1})])])),default:r((()=>[l(N,{ref_key:"btnTableRef",ref:W,data:K.value,"row-key":"ID",onSelectionChange:G},{default:r((()=>[l(_,{type:"selection",width:"55"}),l(_,{label:"按钮名称",prop:"name"}),l(_,{label:"按钮备注",prop:"desc"})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-39017e89"]]);export{N as default};

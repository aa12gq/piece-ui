/*! 
 Build based on gin-vue-admin 
 Time : 1705585352000 */
import{a,a0 as e,o as t,c as o,b as i,d as l,w as s,g as n,t as r,G as p,U as m,k as u,l as c,E as d,a6 as g}from"./index-0efc4537.js";/* empty css                */import{E as f}from"./pagination-956e76f8.js";/* empty css              */import"./tag-c095386a.js";import"./select-59043028.js";import"./scrollbar-ab08f6f1.js";/* empty css               */import{E as v,a as j}from"./table-column-ce6481a3.js";import"./checkbox-aefa5e2d.js";/* empty css                *//* empty css               */import{_ as h,U as w,g as y,d as b,e as _}from"./common-cedd4c68.js";import{C as x}from"./index-e516eee5.js";import{f as k}from"./format-16a20050.js";import{W as C}from"./warningBar-5328b630.js";import{_ as U}from"./_plugin-vue_export-helper-1b428a4d.js";import{E}from"./index-c5b62cef.js";import"./isEqual-aa7e7ef2.js";import"./_Uint8Array-4999d338.js";import"./hasIn-deea815f.js";import"./index-70d4cce8.js";import"./isUndefined-d281c39a.js";import"./strings-a95e1d29.js";import"./debounce-994b39f4.js";import"./index-4b62258d.js";import"./_initCloneObject-b273bb42.js";import"./upload-276f24ce.js";import"./progress-6c49b316.js";import"./cloneDeep-585751f1.js";import"./_baseClone-9af99e91.js";import"./image-viewer-8e1efd47.js";import"./date-8358c12f.js";import"./dictionary-a221ccab.js";import"./sysDictionary-871dfba3.js";/* empty css             */const z=(a,e)=>{var t=new Image;t.setAttribute("crossOrigin","anonymous"),t.onload=function(){var a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(t,0,0,t.width,t.height);var o=a.toDataURL("image/png"),i=document.createElement("a"),l=new MouseEvent("click");i.download=e||"photo",i.href=o,i.dispatchEvent(l)},t.src=a},O={class:"gva-table-box"},S={class:"gva-btn-list"},A=["onClick"],B={class:"gva-pagination"},I=U(Object.assign({name:"Upload"},{__name:"upload",setup(U){const I=a("/api"),T=a(""),V=a(""),D=a(1),L=a(0),G=a(10),M=a({}),P=a([]),R=a=>{G.value=a,H()},q=a=>{D.value=a,H()},H=async()=>{const a=await y({page:D.value,pageSize:G.value,...M.value});0===a.code&&(P.value=a.data.list,L.value=a.data.total,D.value=a.data.page,G.value=a.data.pageSize)};H();return(a,y)=>{const U=c,J=d,N=v,Q=E,W=j,F=f,K=g;return e((t(),o("div",null,[i("div",O,[l(C,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),i("div",S,[l(h,{imageCommon:V.value,"onUpdate:imageCommon":y[0]||(y[0]=a=>V.value=a),onOnSuccess:H},null,8,["imageCommon"]),l(w,{imageUrl:T.value,"onUpdate:imageUrl":y[1]||(y[1]=a=>T.value=a),"file-size":512,"max-w-h":1080,onOnSuccess:H},null,8,["imageUrl"]),l(U,{modelValue:M.value.keyword,"onUpdate:modelValue":y[2]||(y[2]=a=>M.value.keyword=a),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"]),l(J,{type:"primary",icon:"search",onClick:H},{default:s((()=>[n("查询")])),_:1})]),l(W,{data:P.value},{default:s((()=>[l(N,{align:"left",label:"预览",width:"100"},{default:s((a=>[l(x,{"pic-type":"file","pic-src":a.row.url,preview:""},null,8,["pic-src"])])),_:1}),l(N,{align:"left",label:"日期",prop:"UpdatedAt",width:"180"},{default:s((a=>[i("div",null,r(p(k)(a.row.UpdatedAt)),1)])),_:1}),l(N,{align:"left",label:"文件名/备注",prop:"name",width:"180"},{default:s((a=>[i("div",{class:"name",onClick:e=>(async a=>{m.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:a.name}).then((async({value:e})=>{a.name=e,0===(await _(a)).code&&(u({type:"success",message:"编辑成功!"}),H())})).catch((()=>{u({type:"info",message:"取消修改"})}))})(a.row)},r(a.row.name),9,A)])),_:1}),l(N,{align:"left",label:"链接",prop:"url","min-width":"300"}),l(N,{align:"left",label:"标签",prop:"tag",width:"100"},{default:s((a=>[l(Q,{type:"jpg"===a.row.tag?"primary":"success","disable-transitions":""},{default:s((()=>[n(r(a.row.tag),1)])),_:2},1032,["type"])])),_:1}),l(N,{align:"left",label:"操作",width:"160"},{default:s((a=>[l(J,{icon:"download",type:"primary",link:"",onClick:e=>{var t;(t=a.row).url.indexOf("http://")>-1||t.url.indexOf("https://")>-1?z(t.url,t.name):z(I.value+"/"+t.url,t.name)}},{default:s((()=>[n("下载")])),_:2},1032,["onClick"]),l(J,{icon:"delete",type:"primary",link:"",onClick:e=>(async a=>{m.confirm("此操作将永久删除文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await b(a)).code&&(u({type:"success",message:"删除成功!"}),1===P.value.length&&D.value>1&&D.value--,H())})).catch((()=>{u({type:"info",message:"已取消删除"})}))})(a.row)},{default:s((()=>[n("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),i("div",B,[l(F,{"current-page":D.value,"page-size":G.value,"page-sizes":[10,30,50,100],style:{float:"right",padding:"20px"},total:L.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:q,onSizeChange:R},null,8,["current-page","page-size","total"])])])])),[[K,a.fullscreenLoading,void 0,{fullscreen:!0,lock:!0}]])}}}),[["__scopeId","data-v-e597af6f"]]);export{I as default};
